{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"executionInfo":{"elapsed":3576,"status":"ok","timestamp":1675518611882,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"S5N_U-UCXd6u"},"outputs":[],"source":["# Dependencies\n","import tensorflow as tf\n","import pandas as pd\n","import matplotlib.pyplot as plt\n","import numpy as np\n","import os"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21044,"status":"ok","timestamp":1675518639322,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"9UNF3q-ecLqm","outputId":"bf7d9358-bc2a-45a3-fd5a-b92655eefc08"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/gdrive\n"]}],"source":["from google.colab import drive\n","drive.mount(\"/content/gdrive\")"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1675518648735,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"KoAethBsdAT_","outputId":"4f7df409-9fd5-4b5e-9d86-7c57d6fad9d3"},"outputs":[{"name":"stdout","output_type":"stream","text":["/content/gdrive/MyDrive/Project\n"]}],"source":["%cd /content/gdrive/MyDrive/Project"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":515,"status":"ok","timestamp":1675518657442,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"eBqYKSyDaG8h"},"outputs":[],"source":["import zipfile, re, os\n","\n","def extract_nested_zip(zippedFile, toFolder):\n","    \"\"\" Unzip a zip file and its contents, including nested zip files\n","        Delete the zip file(s) after extraction\n","    \"\"\"\n","    with zipfile.ZipFile(zippedFile, 'r') as zfile:\n","        zfile.extractall(path=toFolder)\n","    os.remove(zippedFile)\n","    for root, dirs, files in os.walk(toFolder):\n","        for filename in files:\n","            if re.search(r'\\.zip$', filename):\n","                fileSpec = os.path.join(root, filename)\n","                extract_nested_zip(fileSpec, root)"]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":311},"executionInfo":{"elapsed":555,"status":"error","timestamp":1675518661948,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"6EyO6kkoadAn","outputId":"5f904ed1-a6c1-4e51-d051-d58058ddf313"},"outputs":[{"ename":"FileNotFoundError","evalue":"ignored","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mFileNotFoundError\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m\u003cipython-input-5-5760bed8b53e\u003e\u001b[0m in \u001b[0;36m\u003cmodule\u003e\u001b[0;34m\u001b[0m\n\u001b[0;32m----\u003e 1\u001b[0;31m \u001b[0mextract_nested_zip\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"jigsaw-toxic-comment-classification-challenge.zip\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"/content/gdrive/MyDrive/Project\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m\u003cipython-input-4-77b7177e88b3\u003e\u001b[0m in \u001b[0;36mextract_nested_zip\u001b[0;34m(zippedFile, toFolder)\u001b[0m\n\u001b[1;32m      5\u001b[0m         \u001b[0mDelete\u001b[0m \u001b[0mthe\u001b[0m \u001b[0mzip\u001b[0m \u001b[0mfile\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0ms\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0mafter\u001b[0m \u001b[0mextraction\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m     \"\"\"\n\u001b[0;32m----\u003e 7\u001b[0;31m     \u001b[0;32mwith\u001b[0m \u001b[0mzipfile\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mZipFile\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mzippedFile\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'r'\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mzfile\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      8\u001b[0m         \u001b[0mzfile\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mextractall\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtoFolder\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      9\u001b[0m     \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mremove\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mzippedFile\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/lib/python3.8/zipfile.py\u001b[0m in \u001b[0;36m__init__\u001b[0;34m(self, file, mode, compression, allowZip64, compresslevel, strict_timestamps)\u001b[0m\n\u001b[1;32m   1249\u001b[0m             \u001b[0;32mwhile\u001b[0m \u001b[0;32mTrue\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1250\u001b[0m                 \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-\u003e 1251\u001b[0;31m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfp\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mio\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mopen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfile\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfilemode\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1252\u001b[0m                 \u001b[0;32mexcept\u001b[0m \u001b[0mOSError\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1253\u001b[0m                     \u001b[0;32mif\u001b[0m \u001b[0mfilemode\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmodeDict\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mFileNotFoundError\u001b[0m: [Errno 2] No such file or directory: 'jigsaw-toxic-comment-classification-challenge.zip'"]}],"source":["extract_nested_zip(\"jigsaw-toxic-comment-classification-challenge.zip\", \"/content/gdrive/MyDrive/Project\")"]},{"cell_type":"code","execution_count":6,"metadata":{"executionInfo":{"elapsed":2293,"status":"ok","timestamp":1675518669455,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"jClOYfvGe1ss"},"outputs":[],"source":["df = pd.read_csv(os.path.join(\"jigsaw-toxic-comment-classification-challenge\", 'train.csv'))"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1675518671298,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"CHhvUDVofmZQ","outputId":"a63e0188-8cbe-4314-fe18-deb5f2332ad8"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-51f6cc79-8744-4816-8c93-b2b43a9de627\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eid\u003c/th\u003e\n","      \u003cth\u003ecomment_text\u003c/th\u003e\n","      \u003cth\u003etoxic\u003c/th\u003e\n","      \u003cth\u003esevere_toxic\u003c/th\u003e\n","      \u003cth\u003eobscene\u003c/th\u003e\n","      \u003cth\u003ethreat\u003c/th\u003e\n","      \u003cth\u003einsult\u003c/th\u003e\n","      \u003cth\u003eidentity_hate\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003e0000997932d777bf\u003c/td\u003e\n","      \u003ctd\u003eExplanation\\nWhy the edits made under my usern...\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003e000103f0d9cfb60f\u003c/td\u003e\n","      \u003ctd\u003eD'aww! He matches this background colour I'm s...\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003e000113f07ec002fd\u003c/td\u003e\n","      \u003ctd\u003eHey man, I'm really not trying to edit war. It...\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003e0001b41b1c6bb37e\u003c/td\u003e\n","      \u003ctd\u003e\"\\nMore\\nI can't make any real suggestions on ...\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003e0001d958c54c6e35\u003c/td\u003e\n","      \u003ctd\u003eYou, sir, are my hero. Any chance you remember...\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-51f6cc79-8744-4816-8c93-b2b43a9de627')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","        \n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","      \n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-51f6cc79-8744-4816-8c93-b2b43a9de627 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-51f6cc79-8744-4816-8c93-b2b43a9de627');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n","  "],"text/plain":["                 id                                       comment_text  toxic  \\\n","0  0000997932d777bf  Explanation\\nWhy the edits made under my usern...      0   \n","1  000103f0d9cfb60f  D'aww! He matches this background colour I'm s...      0   \n","2  000113f07ec002fd  Hey man, I'm really not trying to edit war. It...      0   \n","3  0001b41b1c6bb37e  \"\\nMore\\nI can't make any real suggestions on ...      0   \n","4  0001d958c54c6e35  You, sir, are my hero. Any chance you remember...      0   \n","\n","   severe_toxic  obscene  threat  insult  identity_hate  \n","0             0        0       0       0              0  \n","1             0        0       0       0              0  \n","2             0        0       0       0              0  \n","3             0        0       0       0              0  \n","4             0        0       0       0              0  "]},"execution_count":7,"metadata":{},"output_type":"execute_result"}],"source":["df.head()"]},{"cell_type":"code","execution_count":8,"metadata":{"executionInfo":{"elapsed":3,"status":"ok","timestamp":1675518674025,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"1LUZ065d6W96"},"outputs":[],"source":["from tensorflow.keras.layers import TextVectorization"]},{"cell_type":"code","execution_count":9,"metadata":{"executionInfo":{"elapsed":2,"status":"ok","timestamp":1675518676546,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"9tZbcrNS6W6U"},"outputs":[],"source":["X=df['comment_text'] \n","Y=df[df.columns[2:]].values "]},{"cell_type":"code","execution_count":10,"metadata":{"executionInfo":{"elapsed":4,"status":"ok","timestamp":1675518677887,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"alGbF15r6W4K"},"outputs":[],"source":["MAX_FEATURES = 200000"]},{"cell_type":"code","execution_count":11,"metadata":{"executionInfo":{"elapsed":3445,"status":"ok","timestamp":1675518681329,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"OfjOifiV6W1Z"},"outputs":[],"source":["vectorizer = TextVectorization(max_tokens=MAX_FEATURES,\n","                               output_sequence_length=1800,\n","                               output_mode='int')"]},{"cell_type":"code","execution_count":12,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9,"status":"ok","timestamp":1675518681331,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"9MlZ754v6WyU","outputId":"bb14e42f-73cd-42d9-e810-2c535c5ddda0"},"outputs":[{"data":{"text/plain":["pandas.core.series.Series"]},"execution_count":12,"metadata":{},"output_type":"execute_result"}],"source":["type(X)"]},{"cell_type":"code","execution_count":13,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":8,"status":"ok","timestamp":1675518681332,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"2gES2sgn6WvV","outputId":"b4f0efc4-6485-496b-c17b-e47e605ded55"},"outputs":[{"data":{"text/plain":["numpy.ndarray"]},"execution_count":13,"metadata":{},"output_type":"execute_result"}],"source":["type(X.values)"]},{"cell_type":"code","execution_count":14,"metadata":{"executionInfo":{"elapsed":13350,"status":"ok","timestamp":1675518694677,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"KIKQ1M1u7PrY"},"outputs":[],"source":["vectorizer.adapt(X.values)"]},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14,"status":"ok","timestamp":1675518694677,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"1s2Nhqta7aOA","outputId":"90f29fdb-d76c-45d3-f3c5-58bd1107d596"},"outputs":[{"data":{"text/plain":["\u003ctf.Tensor: shape=(5,), dtype=int64, numpy=array([  288,   263,    70, 22460,     5])\u003e"]},"execution_count":15,"metadata":{},"output_type":"execute_result"}],"source":["vectorizer(\"Hello World, I'm dope and i know it\")[:5]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qgF71HZF7c_Z"},"outputs":[],"source":["vectorizer.get_vocabulary()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FzxTZf4h7e-I"},"outputs":[],"source":["vectorized_text = vectorizer(X.values)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"5yXQVEs-7jf_"},"outputs":[],"source":["dataset = tf.data.Dataset.from_tensor_slices((vectorized_text,Y))\n","dataset = dataset.cache()\n","dataset = dataset.shuffle(160000)\n","dataset = dataset.batch(16)\n","dataset = dataset.prefetch(8)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"s6eDKibw7nU6"},"outputs":[],"source":["batch_X, batch_Y = dataset.as_numpy_iterator().next()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9,"status":"ok","timestamp":1675321634298,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"quol4LiX7q5a","outputId":"a0d94a0c-89ce-4da4-e106-de076699d530"},"outputs":[{"data":{"text/plain":["(16, 6)"]},"execution_count":29,"metadata":{},"output_type":"execute_result"}],"source":["batch_Y.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JGtB2Y3f7sUm"},"outputs":[],"source":["train = dataset.take(int(len(dataset)*.7))\n","val = dataset.skip(int(len(dataset)*.7)).take(int(len(dataset)*.2)) \n","test = dataset.skip(int(len(dataset)*.9)).take(int(len(dataset)*.1)) "]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":10,"status":"ok","timestamp":1675321635070,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"nkXusi75743e","outputId":"1a58f74a-0c28-4ba2-9e99-0f631ba011ba"},"outputs":[{"data":{"text/plain":["(6981, 1994, 997)"]},"execution_count":32,"metadata":{},"output_type":"execute_result"}],"source":["len(train), len(val), len(test)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Hlmce2X779Go"},"outputs":[],"source":["train_generator = train.as_numpy_iterator()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1675321635070,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"1fT7H4CT7-1m","outputId":"941825c6-e174-4e44-9e32-ff1693ce0347"},"outputs":[{"data":{"text/plain":["(array([[    2,    63,   259, ...,     0,     0,     0],\n","        [   49, 12710,    13, ...,     0,     0,     0],\n","        [  178,  1815,   488, ...,     0,     0,     0],\n","        ...,\n","        [    5,     8,   456, ...,     0,     0,     0],\n","        [    1,    73,    33, ...,     0,     0,     0],\n","        [  316,    51,    52, ...,     0,     0,     0]]),\n"," array([[0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0],\n","        [1, 1, 1, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0],\n","        [0, 0, 0, 0, 0, 0]]))"]},"execution_count":34,"metadata":{},"output_type":"execute_result"}],"source":["train_generator.next()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RPdVWqTK8ANw"},"outputs":[],"source":["from tensorflow.keras.models import Sequential\n","from tensorflow.keras.layers import LSTM, Dropout, Bidirectional, Dense, Embedding"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JHKbYmna8D9o"},"outputs":[],"source":["model = Sequential()\n","# Creating the Embedding layer\n","model.add(Embedding(MAX_FEATURES+1, 32))\n","#Creating the bidirectional LSTM layer\n","model.add(Bidirectional(LSTM(32, activation='tanh'))) #Bidirectional help us allow information to pass both ways very very used ful when learning NLP\n","# Creating Dense layer for feature extractor dense\n","model.add(Dense(128, activation='relu'))\n","model.add(Dense(256, activation='relu'))\n","model.add(Dense(128, activation='relu'))\n","# Final layer, it's equal to the number of different output\n","model.add(Dense(6, activation='sigmoid'))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"5SJIht6_8V7h"},"outputs":[],"source":["model.compile(loss='BinaryCrossentropy', optimizer='Adam')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":800,"status":"ok","timestamp":1675321636354,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"k-l4Ul5O8Yb2"},"outputs":[{"name":"stdout","output_type":"stream","text":["Model: \"sequential\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," embedding (Embedding)       (None, None, 32)          6400032   \n","                                                                 \n"," bidirectional (Bidirectiona  (None, 64)               16640     \n"," l)                                                              \n","                                                                 \n"," dense (Dense)               (None, 128)               8320      \n","                                                                 \n"," dense_1 (Dense)             (None, 256)               33024     \n","                                                                 \n"," dense_2 (Dense)             (None, 128)               32896     \n","                                                                 \n"," dense_3 (Dense)             (None, 6)                 774       \n","                                                                 \n","=================================================================\n","Total params: 6,491,686\n","Trainable params: 6,491,686\n","Non-trainable params: 0\n","_________________________________________________________________\n"]}],"source":["model.summary()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":24455,"status":"ok","timestamp":1675322284165,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"HMiO76Yu8aDU","outputId":"97f77592-9c9e-43bc-9fa1-73b82c7797c7"},"outputs":[{"name":"stdout","output_type":"stream","text":["6981/6981 [==============================] - 648s 92ms/step - loss: 0.0626 - val_loss: 0.0443\n"]}],"source":["history = model.fit(train, epochs=1, validation_data=val)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1675322284165,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"Gdubmw8m8yBg","outputId":"44d8d97d-8c97-42f4-aff4-00c5fbabe009"},"outputs":[{"data":{"text/plain":["{'loss': [0.06262863427400589], 'val_loss': [0.0442933551967144]}"]},"execution_count":40,"metadata":{},"output_type":"execute_result"}],"source":["history.history"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":282},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1675322284168,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"xDK4m9Me81dI","outputId":"2a221c58-38fe-4f35-9258-58205aab74f7"},"outputs":[{"data":{"text/plain":["\u003cFigure size 576x360 with 0 Axes\u003e"]},"metadata":{},"output_type":"display_data"},{"data":{"image/png":"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\n","text/plain":["\u003cFigure size 432x288 with 1 Axes\u003e"]},"metadata":{},"output_type":"display_data"}],"source":["plt.figure(figsize=(8,5))\n","pd.DataFrame(history.history).plot()\n","plt.show()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Bj8XgqFq87ip"},"outputs":[],"source":["input_text = vectorizer('Veg Biryani is comparable to chicken biryani')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":0,"status":"ok","timestamp":1675322284194,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"Zf5b4D8D8-qW","outputId":"76e812eb-8fb9-4a0b-ecf0-bcee4a726c30"},"outputs":[{"data":{"text/plain":["\u003ctf.Tensor: shape=(1800,), dtype=int64, numpy=array([116685,      1,      9, ...,      0,      0,      0])\u003e"]},"execution_count":43,"metadata":{},"output_type":"execute_result"}],"source":["input_text"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ewOiKm_r9AA8"},"outputs":[],"source":["batch = test.as_numpy_iterator().next()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"24YxO55U9Bmn"},"outputs":[],"source":["res = model.predict(np.expand_dims(input_text,0))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1675322286225,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"1jiltbCp9D7u","outputId":"aa5513e7-e7dc-44be-d37f-b867d9bfab83"},"outputs":[{"name":"stdout","output_type":"stream","text":["1/1 [==============================] - 1s 647ms/step\n"]}],"source":["res = model.predict(np.expand_dims(input_text,0))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1675322286225,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"4m2tt_Ow9Gbh","outputId":"eec90859-9bf2-4ac7-9999-eaa7f18a448c"},"outputs":[{"data":{"text/plain":["array([[3.9235394e-02, 3.7411544e-05, 3.4750768e-03, 1.3979599e-03,\n","        6.8550594e-03, 1.1094919e-03]], dtype=float32)"]},"execution_count":46,"metadata":{},"output_type":"execute_result"}],"source":["res"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eUrUSg2P9Hro"},"outputs":[],"source":["batch_X, batch_Y = test.as_numpy_iterator().next()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13,"status":"ok","timestamp":1675322288381,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"02y4APP49RrG","outputId":"4419634d-0db2-42ff-9bfc-fcbbbdbd77a7"},"outputs":[{"name":"stdout","output_type":"stream","text":["1/1 [==============================] - 0s 60ms/step\n"]},{"data":{"text/plain":["array([[3.50125018e-03, 9.03144013e-08, 1.13542090e-04, 3.40085317e-05,\n","        3.32460331e-04, 2.17552679e-05],\n","       [9.99631166e-01, 2.90846914e-01, 9.78617311e-01, 8.27126112e-03,\n","        8.71722281e-01, 1.36890501e-01],\n","       [1.00149373e-02, 8.89754347e-07, 4.21041332e-04, 1.33254856e-04,\n","        1.09104090e-03, 9.57830271e-05],\n","       [9.90238506e-04, 5.53402701e-09, 2.33152423e-05, 6.45233422e-06,\n","        7.68389873e-05, 3.59946944e-06],\n","       [2.40389351e-03, 4.07788434e-08, 7.22755649e-05, 2.12981849e-05,\n","        2.18653426e-04, 1.30643775e-05],\n","       [2.42733420e-03, 4.33282032e-08, 7.47009835e-05, 2.23203897e-05,\n","        2.22409784e-04, 1.35928158e-05],\n","       [2.93980073e-03, 6.05249184e-08, 9.01120729e-05, 2.67335145e-05,\n","        2.67808908e-04, 1.67213730e-05],\n","       [2.00025341e-03, 2.37718005e-08, 5.32350532e-05, 1.51377790e-05,\n","        1.68278159e-04, 9.18019850e-06],\n","       [1.62694324e-03, 1.75325745e-08, 4.49544787e-05, 1.29827267e-05,\n","        1.40097647e-04, 7.60859575e-06],\n","       [1.59188360e-03, 1.60983120e-08, 4.26000734e-05, 1.22826214e-05,\n","        1.33761525e-04, 7.18677575e-06],\n","       [2.82895728e-03, 5.91637992e-08, 8.91937161e-05, 2.66936222e-05,\n","        2.63801339e-04, 1.66144146e-05],\n","       [2.24990235e-03, 3.52770115e-08, 6.65843181e-05, 1.95664452e-05,\n","        2.02620737e-04, 1.19306196e-05],\n","       [5.33312606e-03, 2.70936084e-07, 2.11037535e-04, 6.74643597e-05,\n","        5.69360913e-04, 4.45445912e-05],\n","       [3.01600737e-03, 8.79303101e-08, 1.10191235e-04, 3.51285526e-05,\n","        3.03277717e-04, 2.14699339e-05],\n","       [5.24241617e-03, 2.76406013e-07, 2.13871244e-04, 6.87288484e-05,\n","        5.73773286e-04, 4.51604647e-05],\n","       [5.64690772e-03, 3.51447824e-07, 2.42583919e-04, 8.01595961e-05,\n","        6.28000067e-04, 5.21065231e-05]], dtype=float32)"]},"execution_count":48,"metadata":{},"output_type":"execute_result"}],"source":["model.predict(batch_X)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":10,"status":"ok","timestamp":1675322288382,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"IWSRB9Pj9Ty3","outputId":"b3834ef5-91d8-4f67-f556-d0b270fa0c5c"},"outputs":[{"name":"stdout","output_type":"stream","text":["1/1 [==============================] - 0s 60ms/step\n"]},{"data":{"text/plain":["array([[0, 0, 0, 0, 0, 0],\n","       [1, 0, 1, 0, 1, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0]])"]},"execution_count":49,"metadata":{},"output_type":"execute_result"}],"source":["(model.predict(batch_X)\u003e0.5).astype(int)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1675322288382,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"wyOmPAjj9WQo","outputId":"0215c3c0-38ac-43e0-c2fe-34847cf38f4b"},"outputs":[{"data":{"text/plain":["array([[0, 0, 0, 0, 0, 0],\n","       [1, 0, 1, 0, 1, 1],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0],\n","       [0, 0, 0, 0, 0, 0]])"]},"execution_count":50,"metadata":{},"output_type":"execute_result"}],"source":["batch_Y"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f1rCsffg9YEy"},"outputs":[],"source":["from tensorflow.keras.metrics import Precision, Recall, CategoricalAccuracy"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZgOQns4a9ama"},"outputs":[],"source":["pre = Precision()\n","re = Recall()\n","acc = CategoricalAccuracy()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":95471,"status":"ok","timestamp":1675322383851,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"g6lZmBXG9cvF","outputId":"b8577814-9fb3-4ee2-8c2e-337e03af491f"},"outputs":[{"name":"stdout","output_type":"stream","text":["1/1 [==============================] - 0s 62ms/step\n","1/1 [==============================] - 0s 59ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 59ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 59ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 64ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 60ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 60ms/step\n","1/1 [==============================] - 0s 77ms/step\n","1/1 [==============================] - 0s 84ms/step\n","1/1 [==============================] - 0s 76ms/step\n","1/1 [==============================] - 0s 90ms/step\n","1/1 [==============================] - 0s 74ms/step\n","1/1 [==============================] - 0s 75ms/step\n","1/1 [==============================] - 0s 81ms/step\n","1/1 [==============================] - 0s 81ms/step\n","1/1 [==============================] - 0s 83ms/step\n","1/1 [==============================] - 0s 75ms/step\n","1/1 [==============================] - 0s 80ms/step\n","1/1 [==============================] - 0s 73ms/step\n","1/1 [==============================] - 0s 73ms/step\n","1/1 [==============================] - 0s 78ms/step\n","1/1 [==============================] - 0s 76ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 59ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 60ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 61ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 61ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 59ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 62ms/step\n","1/1 [==============================] - 0s 61ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 47ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 47ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 62ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 59ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 62ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 59ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 62ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 63ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 61ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 59ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 60ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 64ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 60ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 59ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 59ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 60ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 48ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 58ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 57ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 56ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 52ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 55ms/step\n","1/1 [==============================] - 0s 50ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 51ms/step\n","1/1 [==============================] - 0s 54ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 61ms/step\n","1/1 [==============================] - 0s 53ms/step\n","1/1 [==============================] - 0s 49ms/step\n","1/1 [==============================] - 0s 52ms/step\n"]}],"source":["for batch in test.as_numpy_iterator():\n","  X_true, Y_true = batch\n","  yhat = model.predict(X_true)\n","\n","  Y_true = Y_true.flatten()\n","  yhat = yhat.flatten()\n","  \n","  pre.update_state(Y_true, yhat)\n","  re.update_state(Y_true,yhat)\n","  acc.update_state(Y_true,yhat)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cQ5GTjI49eap"},"outputs":[],"source":["print(f'Precision: {pre.result().numpy()},Recall:{re.result().numpy()},Accuracy: {acc.result().numpy()}')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rjMqTMLv9jkE"},"outputs":[],"source":["!pip install gradio jinja2"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FYbWPSbl9mH8"},"outputs":[],"source":["import gradio as gr"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AiGQejNB9obQ"},"outputs":[],"source":["model = tf.keras.models.load_model('toxicity.h5')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"lSQDbIyM9p9t"},"outputs":[],"source":["df.columns[2:]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XXGJF7Am9rlm"},"outputs":[],"source":["def score_comment(comment):\n","  #we'll take a comment and pass it through vectorizer pipe line\n","  vectorized_comment = vectorizer([comment])\n","  results = model.predict(vectorized_comment)\n","  # This will give us how our prediction look like\n","  text = ''\n","  for idx, col in enumerate(df.columns[2:]):\n","    text += '{}: {}\\n'.format(col, results[0][idx]\u003e0.5)\n","\n","    return text"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6BimfHvS9t1n"},"outputs":[],"source":["interface = gr.Interface(fn=score_comment,\n","                         inputs=gr.inputs.Textbox(lines=2, placeholder='Comment to Score'),\n","                         outputs='text')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":590},"executionInfo":{"elapsed":60,"status":"ok","timestamp":1675322407216,"user":{"displayName":"TANZEER KHAN","userId":"01944582530909577797"},"user_tz":-330},"id":"jezeXPKV9vd4","outputId":"18181275-89cf-4104-e7b5-47ffc688842e"},"outputs":[{"name":"stdout","output_type":"stream","text":["Colab notebook detected. To show errors in colab notebook, set debug=True in launch()\n","Running on public URL: https://d582b082-ba2f-488c.gradio.live\n","\n","This share link expires in 72 hours. For free permanent hosting and GPU upgrades (NEW!), check out Spaces: https://huggingface.co/spaces\n"]},{"data":{"text/html":["\u003cdiv\u003e\u003ciframe src=\"https://d582b082-ba2f-488c.gradio.live\" width=\"100%\" height=\"500\" allow=\"autoplay; camera; microphone; clipboard-read; clipboard-write;\" frameborder=\"0\" allowfullscreen\u003e\u003c/iframe\u003e\u003c/div\u003e"],"text/plain":["\u003cIPython.core.display.HTML object\u003e"]},"metadata":{},"output_type":"display_data"},{"data":{"text/plain":[]},"execution_count":61,"metadata":{},"output_type":"execute_result"}],"source":["interface.launch(share=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iPAm_raC9w-7"},"outputs":[],"source":[]}],"metadata":{"accelerator":"GPU","colab":{"authorship_tag":"ABX9TyNgxyP3RuW8C62N8NfxZGBn","name":"","version":""},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}